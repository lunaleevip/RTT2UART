# ä¸²å£è½¬å‘åŠŸèƒ½ç§»åŠ¨æ€»ç»“

## ğŸ¯ åŠŸèƒ½ç§»åŠ¨æ¦‚è¿°

æ ¹æ®ç”¨æˆ·éœ€æ±‚ï¼Œå°†ä¸²å£è½¬å‘é€‰æ‹©æ¡†ä»ä¸»çª—å£ç§»åŠ¨åˆ°è¿æ¥è®¾ç½®å¯¹è¯æ¡†ä¸­ï¼Œä½¿å…¶æˆä¸ºè¿æ¥é…ç½®çš„ä¸€éƒ¨åˆ†ï¼Œè¿™æ ·æ›´ç¬¦åˆé€»è¾‘å’Œç”¨æˆ·ä½“éªŒã€‚

## ğŸ”§ å®ç°çš„ä¿®æ”¹

### 1. ä»ä¸»çª—å£ç§»é™¤ä¸²å£è½¬å‘æ§ä»¶

#### ç§»é™¤çš„ç»„ä»¶
- âœ… `_create_serial_forward_selector()` æ–¹æ³•
- âœ… `_update_serial_forward_combo()` æ–¹æ³•  
- âœ… `_on_serial_forward_changed()` æ–¹æ³•
- âœ… `serial_forward_label` å’Œ `serial_forward_combo` æ§ä»¶
- âœ… RTTæ§ä»¶å¯ç”¨/ç¦ç”¨ä¸­çš„ä¸²å£è½¬å‘æ§ä»¶ç®¡ç†
- âœ… åº”ç”¨è®¾ç½®ä¸­çš„ä¸²å£è½¬å‘è®¾ç½®æ¢å¤
- âœ… å®šæœŸä»»åŠ¡ä¸­çš„ä¸²å£è½¬å‘æ›´æ–°

#### æ¸…ç†çš„å¼•ç”¨
```python
# ç§»é™¤ä¸»çª—å£ä¸­çš„æ‰€æœ‰ä¸²å£è½¬å‘ç›¸å…³ä»£ç 
# åœ¨UIè®¾ç½®å®Œæˆååˆ›å»ºä¸²å£è½¬å‘é€‰æ‹©æ¡†
self._create_serial_forward_selector()  # âŒ å·²ç§»é™¤

# æ›´æ–°ä¸²å£è½¬å‘é€‰æ‹©æ¡†
self._update_serial_forward_combo()     # âŒ å·²ç§»é™¤

# ä¸²å£è½¬å‘é€‰æ‹©æ¡†
if hasattr(self, 'serial_forward_combo'):  # âŒ å·²ç§»é™¤
    self.serial_forward_combo.setEnabled(enabled)
```

### 2. åœ¨è¿æ¥å¯¹è¯æ¡†ä¸­æ·»åŠ ä¸²å£è½¬å‘è®¾ç½®

#### æ–°å¢çš„UIç»„ä»¶
```python
def _create_serial_forward_controls(self):
    """åœ¨è¿æ¥å¯¹è¯æ¡†ä¸­åˆ›å»ºä¸²å£è½¬å‘è®¾ç½®æ§ä»¶"""
    # åˆ›å»ºä¸²å£è½¬å‘ç»„æ¡†
    self.groupBox_SerialForward = QGroupBox(self)
    self.groupBox_SerialForward.setGeometry(QRect(10, 295, 381, 51))
    self.groupBox_SerialForward.setTitle("ä¸²å£è½¬å‘è®¾ç½®")
    
    # åˆ›å»ºæ ‡ç­¾
    self.label_SerialForward = QLabel(self.groupBox_SerialForward)
    self.label_SerialForward.setGeometry(QRect(13, 20, 61, 20))
    self.label_SerialForward.setText("è½¬å‘å†…å®¹:")
    
    # åˆ›å»ºé€‰æ‹©æ¡†
    self.comboBox_SerialForward = QComboBox(self.groupBox_SerialForward)
    self.comboBox_SerialForward.setGeometry(QRect(80, 18, 291, 22))
```

#### å¯¹è¯æ¡†å¸ƒå±€è°ƒæ•´
```python
# è°ƒæ•´å…¶ä»–æ§ä»¶çš„ä½ç½®
# å°†å¼€å§‹æŒ‰é’®å‘ä¸‹ç§»åŠ¨
self.ui.pushButton_Start.setGeometry(QRect(100, 355, 181, 41))
# å°†çŠ¶æ€æ ‡ç­¾å‘ä¸‹ç§»åŠ¨  
self.ui.status.setGeometry(QRect(290, 355, 91, 31))

# è°ƒæ•´å¯¹è¯æ¡†å¤§å°
self.resize(401, 405)
self.setMinimumSize(QSize(401, 405))
self.setMaximumSize(QSize(401, 405))
```

### 3. åŠŸèƒ½é€»è¾‘å®ç°

#### é€‰æ‹©æ¡†å†…å®¹æ›´æ–°
```python
def _update_serial_forward_combo(self):
    """æ›´æ–°ä¸²å£è½¬å‘é€‰æ‹©æ¡†çš„å†…å®¹"""
    # æ¸…ç©ºç°æœ‰é€‰é¡¹
    self.comboBox_SerialForward.clear()
    
    # æ·»åŠ ç¦ç”¨é€‰é¡¹
    self.comboBox_SerialForward.addItem("ç¦ç”¨è½¬å‘", -1)
    
    # æ·»åŠ æ‰€æœ‰TABé¡µé¢
    if self.main_window and hasattr(self.main_window, 'ui'):
        for i in range(MAX_TAB_SIZE):
            tab_text = self.main_window.ui.tem_switch.tabText(i)
            if i == 0:
                display_text = f"{tab_text} (æ‰€æœ‰æ•°æ®)"
            elif i < 17:
                display_text = f"é€šé“ {tab_text}"
            else:
                # ç­›é€‰æ ‡ç­¾é¡µæ˜¾ç¤ºå®é™…çš„ç­›é€‰æ–‡æœ¬
                if tab_text == "filter":
                    display_text = f"ç­›é€‰ {i-16}: (æœªè®¾ç½®)"
                else:
                    display_text = f"ç­›é€‰ {i-16}: {tab_text}"
            
            self.comboBox_SerialForward.addItem(display_text, i)
```

#### é€‰æ‹©å˜åŒ–å¤„ç†
```python
def _on_serial_forward_changed(self, index):
    """ä¸²å£è½¬å‘é€‰æ‹©å‘ç”Ÿå˜åŒ–æ—¶çš„å¤„ç†"""
    selected_tab = self.comboBox_SerialForward.itemData(index)
    
    # æ›´æ–°ä¸²å£è½¬å‘è®¾ç½®
    if self.rtt2uart:
        self.rtt2uart.set_serial_forward_tab(selected_tab)
    
    # ä¿å­˜è®¾ç½®
    self.settings['serial_forward_tab'] = selected_tab
    
    # æ˜¾ç¤ºçŠ¶æ€ä¿¡æ¯
    if selected_tab == -1:
        self.ui.status.setText("è½¬å‘å·²ç¦ç”¨")
    else:
        tab_name = self.comboBox_SerialForward.currentText()
        self.ui.status.setText(f"è½¬å‘: {tab_name}")
```

### 4. è¿æ¥æµç¨‹é›†æˆ

#### è¿æ¥æˆåŠŸåçš„å¤„ç†
```python
# åœ¨start()æ–¹æ³•çš„è¿æ¥æˆåŠŸéƒ¨åˆ†æ·»åŠ 
# åº”ç”¨ä¸²å£è½¬å‘è®¾ç½®
if hasattr(self, 'comboBox_SerialForward'):
    selected_tab = self.comboBox_SerialForward.itemData(
        self.comboBox_SerialForward.currentIndex())
    if selected_tab is not None:
        self.rtt2uart.set_serial_forward_tab(selected_tab)
        if hasattr(self.main_window, 'append_jlink_log'):
            if selected_tab == -1:
                self.main_window.append_jlink_log("Serial forwarding disabled")
            else:
                tab_name = self.comboBox_SerialForward.currentText()
                self.main_window.append_jlink_log(f"Serial forwarding enabled for: {tab_name}")

# æ›´æ–°ä¸²å£è½¬å‘é€‰æ‹©æ¡†ï¼ˆåœ¨è¿æ¥æˆåŠŸåæ›´æ–°TABåˆ—è¡¨ï¼‰
self._update_serial_forward_combo()
```

#### è®¾ç½®æŒä¹…åŒ–
```python
# åœ¨è®¾ç½®å­—å…¸ä¸­ä¿ç•™ä¸²å£è½¬å‘é…ç½®
self.settings = {
    # ... å…¶ä»–è®¾ç½® ...
    'serial_forward_tab': -1  # é»˜è®¤ç¦ç”¨è½¬å‘
}

# æ¢å¤ä¿å­˜çš„è®¾ç½®
if 'serial_forward_tab' in self.settings:
    forward_tab = self.settings['serial_forward_tab']
    for i in range(self.comboBox_SerialForward.count()):
        if self.comboBox_SerialForward.itemData(i) == forward_tab:
            self.comboBox_SerialForward.setCurrentIndex(i)
            break
```

## ğŸ¨ ç”¨æˆ·ç•Œé¢æ”¹è¿›

### è¿æ¥å¯¹è¯æ¡†å¸ƒå±€
- âœ… **æ–°å¢ç»„æ¡†**ï¼š"ä¸²å£è½¬å‘è®¾ç½®" ç»„æ¡†ï¼Œä½äºUARTé…ç½®ä¸‹æ–¹
- âœ… **é€‰æ‹©æ¡†**ï¼šåŒ…å«æ‰€æœ‰TABé¡µé¢é€‰é¡¹ï¼Œå®½åº¦å æ»¡ç»„æ¡†
- âœ… **çŠ¶æ€æ˜¾ç¤º**ï¼šåœ¨å¯¹è¯æ¡†çŠ¶æ€æ ‡ç­¾ä¸­æ˜¾ç¤ºå½“å‰è½¬å‘è®¾ç½®
- âœ… **å¤§å°è°ƒæ•´**ï¼šå¯¹è¯æ¡†é«˜åº¦ä»345å¢åŠ åˆ°405ï¼Œå®¹çº³æ–°æ§ä»¶

### æ§ä»¶å¸ƒå±€ä¼˜åŒ–
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Connection to J-Link                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Specify Target Device               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Target Interface And Speed          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ UART Config                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ä¸²å£è½¬å‘è®¾ç½®                         â”‚  â† æ–°å¢
â”‚ è½¬å‘å†…å®¹: [é€‰æ‹©æ¡†........................] â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â–¡ Reset target                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚           [Start]         çŠ¶æ€æ˜¾ç¤º   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ”§ æŠ€æœ¯ä¼˜åŠ¿

### 1. é€»è¾‘åˆç†æ€§
- âœ… **é…ç½®é›†ä¸­**ï¼šä¸²å£è½¬å‘ä½œä¸ºè¿æ¥é…ç½®çš„ä¸€éƒ¨åˆ†ï¼Œé€»è¾‘æ›´æ¸…æ™°
- âœ… **æµç¨‹ç»Ÿä¸€**ï¼šåœ¨è¿æ¥è®¾ç½®é˜¶æ®µå°±ç¡®å®šè½¬å‘ç­–ç•¥
- âœ… **çŠ¶æ€ä¸€è‡´**ï¼šè½¬å‘è®¾ç½®ä¸è¿æ¥çŠ¶æ€åŒæ­¥

### 2. ç”¨æˆ·ä½“éªŒ
- âœ… **é…ç½®ä¾¿æ·**ï¼šåœ¨è¿æ¥å‰å°±å¯ä»¥è®¾ç½®è½¬å‘é€‰é¡¹
- âœ… **ç•Œé¢ç®€æ´**ï¼šä¸»çª—å£ç•Œé¢æ›´åŠ ç®€æ´ï¼Œä¸“æ³¨äºæ•°æ®æ˜¾ç¤º
- âœ… **æ“ä½œç›´è§‚**ï¼šè½¬å‘è®¾ç½®ä¸å…¶ä»–è¿æ¥å‚æ•°åœ¨åŒä¸€ç•Œé¢

### 3. åŠŸèƒ½å®Œæ•´æ€§
- âœ… **é€‰é¡¹é½å…¨**ï¼šåŒ…å«æ‰€æœ‰TABé¡µé¢çš„è½¬å‘é€‰é¡¹
- âœ… **å®æ—¶åŒæ­¥**ï¼šç­›é€‰æ–‡æœ¬ä¿®æ”¹åé€‰æ‹©æ¡†å†…å®¹è‡ªåŠ¨æ›´æ–°
- âœ… **è®¾ç½®æŒä¹…åŒ–**ï¼šè½¬å‘é…ç½®è‡ªåŠ¨ä¿å­˜å’Œæ¢å¤
- âœ… **çŠ¶æ€åé¦ˆ**ï¼šè½¬å‘çŠ¶æ€åœ¨è¿æ¥æ—¥å¿—å’ŒçŠ¶æ€æ ä¸­æ˜¾ç¤º

## ğŸ“‹ åŠŸèƒ½éªŒè¯

### è¿æ¥å¯¹è¯æ¡†æµ‹è¯•
- [x] ä¸²å£è½¬å‘è®¾ç½®ç»„æ¡†æ­£ç¡®æ˜¾ç¤º
- [x] é€‰æ‹©æ¡†åŒ…å«æ‰€æœ‰é¢„æœŸé€‰é¡¹
- [x] é€‰æ‹©å˜åŒ–æ—¶çŠ¶æ€æ­£ç¡®æ›´æ–°
- [x] å¯¹è¯æ¡†å¤§å°å’Œå¸ƒå±€åˆç†

### è½¬å‘åŠŸèƒ½æµ‹è¯•  
- [x] è¿æ¥æˆåŠŸåè½¬å‘è®¾ç½®æ­£ç¡®åº”ç”¨
- [x] ä¸åŒTABé¡µé¢çš„æ•°æ®èƒ½å¤Ÿæ­£ç¡®è½¬å‘
- [x] ç­›é€‰æ•°æ®è½¬å‘åŠŸèƒ½æ­£å¸¸
- [x] ç¦ç”¨è½¬å‘åŠŸèƒ½æ­£å¸¸

### è®¾ç½®æŒä¹…åŒ–æµ‹è¯•
- [x] è½¬å‘è®¾ç½®èƒ½å¤Ÿæ­£ç¡®ä¿å­˜
- [x] ç¨‹åºé‡å¯åè®¾ç½®æ­£ç¡®æ¢å¤
- [x] è®¾ç½®å˜åŒ–å®æ—¶ä¿å­˜

## ğŸ‰ æ€»ç»“

æˆåŠŸå°†ä¸²å£è½¬å‘åŠŸèƒ½ä»ä¸»çª—å£ç§»åŠ¨åˆ°è¿æ¥è®¾ç½®å¯¹è¯æ¡†ä¸­ï¼Œå®ç°äº†ï¼š

### âœ… å®Œæˆçš„æ”¹è¿›
1. **ç•Œé¢é€»è¾‘ä¼˜åŒ–**ï¼šä¸²å£è½¬å‘è®¾ç½®ç°åœ¨ä½œä¸ºè¿æ¥é…ç½®çš„ä¸€éƒ¨åˆ†
2. **ç”¨æˆ·ä½“éªŒæå‡**ï¼šé…ç½®æ›´åŠ é›†ä¸­å’Œç›´è§‚
3. **åŠŸèƒ½å®Œæ•´ä¿ç•™**ï¼šæ‰€æœ‰åŸæœ‰åŠŸèƒ½éƒ½å¾—åˆ°ä¿ç•™å’Œæ­£ç¡®å®ç°
4. **ä»£ç ç»“æ„ä¼˜åŒ–**ï¼šç›¸å…³åŠŸèƒ½ä»£ç æ›´åŠ é›†ä¸­å’Œæ¨¡å—åŒ–

### ğŸ¯ ç”¨æˆ·æ”¶ç›Š
- **é…ç½®æ›´ä¾¿æ·**ï¼šåœ¨è¿æ¥è®¾ç½®é˜¶æ®µå°±å¯ä»¥é…ç½®è½¬å‘é€‰é¡¹
- **ç•Œé¢æ›´ç®€æ´**ï¼šä¸»çª—å£ä¸“æ³¨äºæ•°æ®æ˜¾ç¤ºï¼Œä¸å†æœ‰é…ç½®æ§ä»¶
- **é€»è¾‘æ›´æ¸…æ™°**ï¼šè½¬å‘è®¾ç½®ä¸è¿æ¥å‚æ•°åœ¨åŒä¸€ç•Œé¢ï¼Œé€»è¾‘å…³ç³»æ›´æ˜ç¡®
- **æ“ä½œæ›´ç›´è§‚**ï¼šç”¨æˆ·å¯ä»¥åœ¨è¿æ¥å‰å°±æ˜ç¡®è½¬å‘ç­–ç•¥

è¿™æ¬¡åŠŸèƒ½ç§»åŠ¨å¤§å¤§æå‡äº†RTT2UARTå·¥å…·çš„ç”¨æˆ·ä½“éªŒå’Œç•Œé¢é€»è¾‘æ€§ï¼
