# 快速部署参考卡

## 🚀 一行命令部署

```bash
# 最简单的方式（推荐）
quick_deploy.bat dist\XexunRTT_v2.5.exe

# 带更新说明
quick_deploy.bat dist\XexunRTT_v2.5.exe "修复Bug"
```

---

## 📋 完整工作流程

### 1. 修改版本号

```python
# version.py
CURRENT_VERSION = "2.5"
```

### 2. 编译

```bash
pyinstaller XexunRTT_onefile_v2_2.spec
# 生成: dist/XexunRTT_v2.5.exe
```

### 3. 部署

```bash
quick_deploy.bat dist\XexunRTT_v2.5.exe "更新说明"
```

### 4. 上传

将 `updates` 目录中的所有文件上传到服务器：
```
http://sz.xexun.com:18891/uploads/xexunrtt/updates/win/
```

---

## 🔧 自动化功能

- ✅ 自动从文件名提取版本号
- ✅ 自动读取 `updates/version.json` 历史版本
- ✅ 自动生成增量补丁
- ✅ 自动更新版本信息
- ✅ 自动清理旧补丁（保留最近3个）

---

## 📊 生成的文件

```
updates/
├── XexunRTT_v2.5.exe          (新版本完整文件)
├── patch_2.4_to_2.5.patch     (增量补丁，节省90%流量)
└── version.json                (版本信息)
```

---

## 💡 高级用法

```bash
# 自定义输出目录
python deploy_update.py dist\XexunRTT_v2.5.exe --output my_updates

# 保留更多补丁（默认3个）
python deploy_update.py dist\XexunRTT_v2.5.exe --max-patches 5

# 查看帮助
python deploy_update.py --help
```

---

## ⚠️ 注意事项

1. **文件名必须包含版本号**
   - ✅ `XexunRTT_v2.5.exe`
   - ❌ `XexunRTT.exe`

2. **bsdiff4 必须安装**
   ```bash
   pip install bsdiff4
   ```

3. **上传所有生成的文件**
   - 完整 EXE 文件
   - 补丁文件
   - version.json

---

## 🎯 就是这么简单！

之前需要 10 个参数的命令：
```bash
python deploy_update.py --new-version 2.5 --new-file dist/XexunRTT.exe --old-versions dist/old/XexunRTT_2.4.exe ...
```

现在只需要：
```bash
quick_deploy.bat dist\XexunRTT_v2.5.exe
```

**简化了 90% 的操作！** 🎉

