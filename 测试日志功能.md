# 测试日志功能

## ✅ 修复完成！

日志配置已移到文件开头，现在会正常记录所有信息。

---

## 🚀 如何测试

### 步骤 1: 清空旧日志（可选）

```bash
del %LOCALAPPDATA%\XexunRTT\logs\xexunrtt.log
```

### 步骤 2: 重新编译

```bash
rebuild_clean.bat
```

### 步骤 3: 运行程序并监控日志

**方法 1: 使用实时监控（推荐）**

在一个终端窗口运行：
```bash
tail_log.bat
```

在另一个终端窗口运行编译后的 EXE：
```bash
dist\XexunRTT_v2.4.exe
```

**方法 2: 使用一键测试脚本**

```bash
test_log_realtime.bat
```

会自动打开两个窗口：程序窗口和日志监控窗口

---

## 📊 应该看到的日志

### 启动时立即显示

```
======================================================================
XexunRTT Starting...
Log file: C:\Users\xxx\AppData\Local\XexunRTT\logs\xexunrtt.log
Python version: 3.13.6 ...
Frozen: True
======================================================================
配置文件加载成功: ...
System locale: zh_CN, language: Language.Chinese, country: Country.China
[OK] Chinese translation loaded successfully
Window initialized with ID: ...
```

### 5秒后显示（自动更新检查）

```
Auto update check scheduled
Using default production server: http://sz.xexun.com:18891/...
Checking for updates from: http://...
Current file hash: 341b0e3cda3d5280...
✅ Current file integrity verified
Found patch from 2.4 to 2.4.1
Patch size: 420102 bytes
Found update: 2.4.1
```

---

## 🔍 如果还是没有日志

### 检查 1: 日志文件是否存在

```bash
dir %LOCALAPPDATA%\XexunRTT\logs\
```

应该看到 `xexunrtt.log` 文件

### 检查 2: 文件大小

```bash
dir %LOCALAPPDATA%\XexunRTT\logs\xexunrtt.log
```

如果大小是 0 字节，说明程序可能没有正常启动

### 检查 3: 手动查看

```bash
notepad %LOCALAPPDATA%\XexunRTT\logs\xexunrtt.log
```

### 检查 4: 权限问题

确保程序有写入权限：
```bash
# 右键 EXE -> 属性 -> 兼容性 -> 以管理员身份运行
```

---

## 📝 日志级别

当前配置：`logging.INFO`

会记录：
- ✅ INFO - 正常信息
- ✅ WARNING - 警告
- ✅ ERROR - 错误

不会记录：
- ❌ DEBUG - 调试信息（除非需要，可以改为 `logging.DEBUG`）

---

## 💡 修改日志级别

如果需要更详细的日志，编辑 `main_window.py` 第 40 行：

```python
logging.basicConfig(
    level=logging.DEBUG,  # 改为 DEBUG
    ...
)
```

然后重新编译。

---

## ✅ 现在试试

```bash
# 1. 重新编译
rebuild_clean.bat

# 2. 启动并监控
test_log_realtime.bat

# 3. 等待 5 秒，查看自动更新日志
```

应该能看到完整的日志了！ 🎉

