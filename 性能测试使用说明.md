# RTT性能测试工具使用说明

## 功能概述

性能测试工具可以帮助你：
- 🚀 **大量数据测试**：向每个页面填入10000行随机文本，模拟真实使用场景
- ⚡ **实时写入测试**：以可配置的速度（100ms间隔，1-5行随机）持续写入数据
- 📊 **性能监控**：实时监控CPU、内存使用率和数据处理速度
- 🔍 **瓶颈检测**：自动分析性能瓶颈并给出优化建议

## 启动方式

### 方式1：从主程序启动（推荐）
1. 运行主程序 `main_window.py`
2. 点击菜单栏：**工具 > 性能测试**
3. 性能测试窗口将打开并连接到主程序

### 方式2：独立启动
1. 运行 `run_performance_test.bat`
2. 或直接执行：`python test_performance.py`
3. 注意：独立模式无法连接主程序，仅用于界面测试

## 使用步骤

### 第一步：准备测试数据
1. 点击 **"1. 准备测试数据 (10000行)"**
2. 等待数据生成完成（通常需要几秒钟）
3. 状态显示 "已准备 10000 行" 表示成功

### 第二步：填充页面
1. 点击 **"2. 填充所有页面"**
2. 程序将向所有RTT通道（0-15）填充1000行随机数据
3. 观察主程序各个标签页是否正常显示数据

### 第三步：配置测试参数
- **写入间隔(ms)**：数据写入的时间间隔，默认100ms
- **每次行数**：每次写入的行数，默认3行，范围1-5行

### 第四步：开始性能测试
1. 点击 **"3. 开始性能测试"**
2. 程序开始模拟持续的数据写入
3. 实时观察性能指标变化

## 性能指标说明

### 基础指标
- **运行时间(s)**：测试运行的总时间
- **CPU使用率(%)**：当前CPU占用百分比
- **系统内存(%)**：系统内存使用百分比
- **进程内存(MB)**：当前进程占用的内存

### 数据处理指标
- **已写数据(MB)**：累计写入的数据量
- **已写行数**：累计写入的行数
- **数据速率(KB/s)**：平均数据写入速度
- **行速率(行/s)**：平均行写入速度

## 瓶颈分析

### 自动检测项目
- ⚠️ **CPU使用率过高** (>80%)：可能影响响应速度
- ⚠️ **系统内存不足** (>85%)：可能导致系统卡顿
- ⚠️ **进程内存过高** (>500MB)：建议重启程序释放内存
- 🚨 **数据处理速度不足** (<10行/s)：严重性能问题

### 性能等级（优化后标准）
- 🚀 **超强** (>1000行/s)：极致性能，达到理论上限
- ✅ **优秀** (500-1000行/s)：性能卓越
- ⚡ **良好** (100-500行/s)：性能很好
- 📊 **一般** (50-100行/s)：可接受的性能
- ⚠️ **较慢** (10-50行/s)：需要关注
- 🚨 **严重不足** (<10行/s)：需要优化

## 测试建议

### 测试场景
1. **基准测试**：空闲状态下的性能基准
2. **压力测试**：高频数据写入下的表现
3. **长时间测试**：运行数小时检查内存泄漏
4. **多通道测试**：同时向多个通道写入数据

### 优化建议
1. **如果CPU使用率过高**：
   - 减少写入频率（增加间隔时间）
   - 减少每次写入的行数
   - 检查其他占用CPU的程序

2. **如果内存占用过高**：
   - 定期清理日志缓冲区
   - 减少缓冲区大小设置
   - 重启程序释放内存

3. **如果数据处理慢**：
   - 检查磁盘I/O性能
   - 优化文本渲染算法
   - 考虑使用更高效的数据结构

## 注意事项

1. **测试期间避免其他操作**：确保测试结果的准确性
2. **监控系统资源**：防止系统过载
3. **及时停止测试**：发现异常时立即停止
4. **保存测试结果**：记录关键性能数据用于分析

## 故障排除

### 常见问题
1. **无法启动测试**：检查是否已连接设备并开始RTT调试
2. **数据写入失败**：检查worker对象是否正常初始化
3. **性能数据异常**：检查系统是否有其他高负载程序

### 错误信息
- `未找到worker对象`：主程序未正常初始化
- `写入数据时出错`：数据写入过程中发生异常
- `启动性能测试失败`：性能测试模块初始化失败

## 技术原理

### 数据生成
- 使用随机字符生成算法创建测试数据
- 每行包含序号和随机内容，便于跟踪

### 写入模拟
- 随机选择通道进行写入（30%概率ALL通道，70%概率单个通道）
- 模拟真实RTT数据的随机性和突发性

### 性能监控
- 使用psutil库监控系统资源
- 实时计算数据处理速率和效率指标
- 智能分析性能瓶颈并给出建议

这个工具将帮助你全面了解RTT程序在大数据量处理时的性能表现，及时发现和解决性能瓶颈。
